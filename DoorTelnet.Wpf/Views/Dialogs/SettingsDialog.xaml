<Window x:Class="DoorTelnet.Wpf.Views.Dialogs.SettingsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings" Height="580" Width="750" MinWidth="750" MinHeight="580" WindowStartupLocation="CenterOwner"
        Background="{StaticResource Brush.Background}" Foreground="{StaticResource Brush.Text}" WindowStyle="ToolWindow">
    <Window.Resources>
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource Brush.AccentLight}"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="{StaticResource Brush.TextMuted}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,12,0"/>
            <Setter Property="Width" Value="120"/>
        </Style>
        <Style x:Key="InputRowStyle" TargetType="StackPanel">
            <Setter Property="Orientation" Value="Horizontal"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        <!-- Add white text style for TextBox on dark backgrounds -->
        <Style x:Key="DarkTextBoxStyle" TargetType="TextBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CaretBrush" Value="White"/>
        </Style>
    </Window.Resources>
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource Brush.Panel}" BorderBrush="{StaticResource Brush.Border}" 
                BorderThickness="1" CornerRadius="4" Padding="12,8" Margin="0,0,0,12">
            <StackPanel>
                <TextBlock Text="Application Settings" FontSize="16" FontWeight="Bold"/>
                <TextBlock Text="Configure connection, interface, and automation settings" 
                           FontSize="11" Foreground="{StaticResource Brush.TextMuted}" Margin="0,2,0,0"/>
            </StackPanel>
        </Border>

        <!-- Tab Content -->
        <TabControl Grid.Row="1" Background="{StaticResource Brush.Panel}" 
                    BorderBrush="{StaticResource Brush.Border}" 
                    BorderThickness="1"
                    Margin="0,0,0,12">
            
            <!-- Connection Tab -->
            <TabItem>
                <TabItem.Header>
                    <TextBlock Text="Connection" Padding="8,4" FontSize="12"/>
                </TabItem.Header>
                <Grid>
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                        <StackPanel Margin="12">
                            <TextBlock Text="Server Connection" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <StackPanel Style="{StaticResource InputRowStyle}">
                                <TextBlock Text="Host" Style="{StaticResource LabelStyle}"/>
                                <TextBox Width="280" Text="{Binding Host, UpdateSourceTrigger=PropertyChanged}" 
                                         ToolTip="Server hostname or IP address"/>
                            </StackPanel>
                            
                            <StackPanel Style="{StaticResource InputRowStyle}">
                                <TextBlock Text="Port" Style="{StaticResource LabelStyle}"/>
                                <TextBox Width="120" Text="{Binding Port, UpdateSourceTrigger=PropertyChanged}" 
                                         ToolTip="Server port number"/>
                            </StackPanel>
                            
                            <StackPanel Style="{StaticResource InputRowStyle}">
                                <TextBlock Text="Last User" Style="{StaticResource LabelStyle}"/>
                                <TextBox Width="280" Text="{Binding LastUser, UpdateSourceTrigger=PropertyChanged}" 
                                         ToolTip="Last username used for connection"/>
                            </StackPanel>
                            
                            <Separator Margin="0,8,0,16" Background="{StaticResource Brush.Border}"/>
                            
                            <TextBlock Text="Auto Reconnect" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <CheckBox Content="Enable automatic reconnection on disconnect" 
                                      IsChecked="{Binding AutoReconnect}" Margin="0,0,0,12"
                                      ToolTip="Automatically attempt to reconnect if connection is lost"/>
                            
                            <StackPanel Style="{StaticResource InputRowStyle}">
                                <TextBlock Text="Delay (seconds)" Style="{StaticResource LabelStyle}"/>
                                <TextBox Width="120" Text="{Binding AutoReconnectDelaySec, UpdateSourceTrigger=PropertyChanged}" 
                                         ToolTip="Number of seconds to wait before attempting reconnection"
                                         IsEnabled="{Binding AutoReconnect}"/>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            
            <!-- UI Tab -->
            <TabItem>
                <TabItem.Header>
                    <TextBlock Text="Interface" Padding="8,4" FontSize="12"/>
                </TabItem.Header>
                <Grid>
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                        <StackPanel Margin="12">
                            <TextBlock Text="Appearance" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <StackPanel Style="{StaticResource InputRowStyle}">
                                <TextBlock Text="Theme" Style="{StaticResource LabelStyle}"/>
                                <TextBox Width="280" Text="{Binding Theme, UpdateSourceTrigger=PropertyChanged}" 
                                         ToolTip="Theme name (requires restart to apply)"/>
                            </StackPanel>
                            
                            <TextBlock Text="Current theme: Dark (default)" FontSize="10" 
                                       Foreground="{StaticResource Brush.TextMuted}" Margin="132,0,0,8"/>
                            
                            <Separator Margin="0,8,0,16" Background="{StaticResource Brush.Border}"/>
                            
                            <TextBlock Text="Note: Additional UI customization options will be added in future updates." 
                                       FontSize="10" Foreground="{StaticResource Brush.TextMuted}" 
                                       TextWrapping="Wrap" Margin="0,0,0,8"/>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            
            <!-- Login Script Tab -->
            <TabItem>
                <TabItem.Header>
                    <TextBlock Text="Login Script" Padding="8,4" FontSize="12"/>
                </TabItem.Header>
                <Grid>
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                        <StackPanel Margin="12">
                            <TextBlock Text="Automated Login Commands" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <CheckBox Content="Execute login script after successful authentication" 
                                      IsChecked="{Binding SendLoginScript}" Margin="0,0,0,12"
                                      ToolTip="Run the script below after logging in"/>
                            
                            <TextBlock Text="Script Commands" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,4"/>
                            <TextBlock TextWrapping="Wrap" FontSize="10" Foreground="{StaticResource Brush.TextMuted}" Margin="0,0,0,6" xml:space="preserve"><Run Text="Supports: "/><Run Text="{}{ENTER}" FontFamily="Consolas"/><Run Text=" for new line, "/><Run Text="{}{WAIT:ms}" FontFamily="Consolas"/><Run Text=" for delays (e.g., "/><Run Text="{}{WAIT:1000}" FontFamily="Consolas"/><Run Text=" waits 1 second)"/></TextBlock>
                            
                            <Border Background="{StaticResource Brush.Panel}" BorderBrush="{StaticResource Brush.Border}" 
                                    BorderThickness="1" CornerRadius="3" Margin="0,0,0,12">
                                <TextBox Text="{Binding LoginScript, UpdateSourceTrigger=PropertyChanged}" 
                                         AcceptsReturn="True" 
                                         MinHeight="150"
                                         MaxHeight="250"
                                         Padding="8"
                                         FontFamily="Consolas"
                                         FontSize="11"
                                         HorizontalScrollBarVisibility="Auto" 
                                         VerticalScrollBarVisibility="Auto"
                                         TextWrapping="NoWrap"
                                         Style="{StaticResource DarkTextBoxStyle}"
                                         IsEnabled="{Binding SendLoginScript}"/>
                            </Border>
                            
                            <Separator Margin="0,0,0,12" Background="{StaticResource Brush.Border}"/>
                            
                            <TextBlock Text="Example Script:" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,4"/>
                            <Border Background="#1a1d21" BorderBrush="#333" BorderThickness="1" CornerRadius="3" Padding="8" Margin="0,0,0,4">
                                <TextBlock FontFamily="Consolas" FontSize="10" Foreground="{StaticResource Brush.TextMuted}" xml:space="preserve"><Run Text="{}1{ENTER}"/><LineBreak/><Run Text="{}{WAIT:500}"/><LineBreak/><Run Text="look"/><LineBreak/><Run Text="{}{WAIT:300}"/><LineBreak/><Run Text="inv"/></TextBlock>
                            </Border>
                            <TextBlock Text="This example selects character #1, waits 500ms, looks around, waits 300ms, then checks inventory" 
                                       FontSize="9" Foreground="{StaticResource Brush.TextMuted}" 
                                       TextWrapping="Wrap" Margin="0,0,0,8"/>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Footer Buttons -->
        <Border Grid.Row="2" Background="{StaticResource Brush.Panel}" BorderBrush="{StaticResource Brush.Border}" 
                BorderThickness="1,1,1,0" Padding="12,8">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Save" Width="100" Command="{Binding SaveCommand}" Margin="0,0,8,0"
                        ToolTip="Save settings and apply changes"/>
                <Button Content="Reload" Width="100" Command="{Binding ReloadCommand}" Margin="0,0,8,0"
                        ToolTip="Reload settings from file (discards unsaved changes)"/>
                <Button Content="Close" Width="100" Click="Close_Click"
                        ToolTip="Close settings window"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>